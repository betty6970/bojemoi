# Upstream for Faraday service
upstream faraday{
    least_conn;
    server base_faraday:5985 max_fails=3 fail_timeout=30s;
    keepalive 32;
}

# Upstream for OWASP ZAP
upstream base_zap{
    least_conn;
    server zap:8080 max_fails=3 fail_timeout=30s;
    keepalive 32;
}

# Upstream for Burp Suite (if exposed)
upstream base_burp{
    least_conn;
    server burp:8080 max_fails=3 fail_timeout=30s;
    keepalive 32;
}

# Upstream for Grafana
upstream base_grafana_backend {
    least_conn;
    server base_grafana:3000 max_fails=3 fail_timeout=30s;
    keepalive 32;
}

# Upstream for Prometheus
upstream prometheus{
    least_conn;
    server base_prometheus:9090 max_fails=3 fail_timeout=30s;
    keepalive 32;
}

# Upstream for Metasploit RPC (if needed)
upstream base_msfrpcd{
    least_conn;
    server metasploit:55553 max_fails=3 fail_timeout=30s;
    keepalive 16;
}

# Upstream for Loki
upstream base_loki{
    least_conn;
    server base_loki:3100 max_fails=3 fail_timeout=30s;
    keepalive 32;
}

# Upstream for Suricata (if web interface)
upstream base_suricata{
    least_conn;
    server base_suricata:443 max_fails=3 fail_timeout=30s;
    keepalive 16;
}
