#onfiguration optimisée pour Docker Swarm
uid = root
gid = root
use chroot = no
max connections = 20
timeout = 300
log file = /var/log/rsync/rsyncd.log
log format = %t [%p] %o %h [%a] %m (%u) %f %l

# Réseau Docker overlay
hosts allow = 10.0.9.0/24 172.18.0.0/16
hosts deny = *

# Optimisations réseau
socket options = TCP_NODELAY SO_KEEPALIVE
transfer logging = yes
dont compress = *.gz *.tgz *.zip *.z *.Z *.rpm *.deb *.bz2 *.xz *.lz4

[swarm_data]
    path = /opt/bojemoi
    comment = Réplication Swarm
    read only = no
    list = yes
    hosts allow = 10.0.9.0/24
    ignore nonreadable = yes
    numeric ids = yes
    max connections = 1

    # Filtres pour éviter les fichiers temporaires
    exclude = .tmp/ .cache/ *.log~ .DS_Store Thumbs.db
    exclude = /proc/ /sys/ /dev/
#    exclude = /opt/bojemoi/dump/

[swarm_boot]
    path = /opt/bojemoi_boot
    comment = Réplication Boot Services
    read only = no
    list = yes
    hosts allow = 10.0.9.0/24
    ignore nonreadable = yes
    numeric ids = yes
    max connections = 1

    # Filtres pour éviter les fichiers temporaires
    exclude = .tmp/ .cache/ *.log~ .DS_Store Thumbs.db

[swarm_ml-threat]
    path = /opt/bojemoi-ml-threat
    comment = Réplication ML Threat Intel
    read only = no
    list = yes
    hosts allow = 10.0.9.0/24
    ignore nonreadable = yes
    numeric ids = yes
    max connections = 1

    # Filtres pour éviter les fichiers temporaires
    exclude = .tmp/ .cache/ *.log~ .DS_Store Thumbs.db

[swarm_telegram]
    path = /opt/bojemoi-telegram
    comment = Réplication ML Threat Intel
    read only = no
    list = yes
    hosts allow = 10.0.9.0/24
    ignore nonreadable = yes
    numeric ids = yes
    max connections = 1

    # Filtres pour éviter les fichiers temporaires
    exclude = .tmp/ .cache/ *.log~ .DS_Store Thumbs.db

[swarm_logs]
    path = /var/log/rsync
    comment = Logs de synchronisation
    read only = yes
    list = yes
    hosts allow = 10.0.9.254
    max connections = 2

