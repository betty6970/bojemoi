# Pentest Orchestrator

Manage the pentest orchestrator - check status, list plugins, run scans.

## Arguments

- `status` - Show orchestrator and plugin status
- `plugins` - List available plugins and functions
- `scan <target> [type]` - Queue a scan (types: full, web, network, vuln, cms)
- `results` - List recent scan results

## Instructions

### For `status`:
```bash
cd /opt/bojemoi/samsonov/pentest_orchestrator
echo "=== Orchestrator Status ==="
docker service ls | grep -E "pentest|nuclei|zap|faraday"
echo -e "\n=== Plugin Status ==="
python3 -c "
import sys
sys.path.insert(0, 'plugins')
plugins = ['plugin_faraday', 'plugin_nuclei', 'plugin_zap', 'plugin_masscan', 'plugin_burp', 'plugin_metasploit', 'plugin_vulnx']
for p in plugins:
    try:
        mod = __import__(p)
        status = mod.get_status() if hasattr(mod, 'get_status') else {'status': 'loaded'}
        state = status.get('status', 'unknown')
        icon = '✓' if state in ('connected', 'loaded', 'success') else '✗'
        print(f'  {icon} {p}: {state}')
    except Exception as e:
        print(f'  ✗ {p}: error - {e}')
"
```

### For `plugins`:
```bash
cd /opt/bojemoi/samsonov/pentest_orchestrator && python3 -c "
from main import PluginManager
pm = PluginManager()
pm.load_plugins()
print('\\n=== Available Functions ===')
for name, info in pm.plugins_metadata.items():
    print(f\"\\n[{info['tool']}] {name} v{info['version']}\")
    print(f\"  {info['description']}\")
    print(f\"  Functions: {', '.join(info['functions'][:5])}\")
    if len(info['functions']) > 5:
        print(f\"  ... and {len(info['functions'])-5} more\")
"
```

### For `scan <target> [type]`:
Show how to trigger a scan via Redis:
```bash
echo "To trigger a scan, publish to Redis:"
echo ""
echo "redis-cli -h redis PUBLISH pentest:commands '{\"action\": \"scan\", \"target\": \"<TARGET>\", \"type\": \"<TYPE>\"}'"
echo ""
echo "Scan types: full, web, network, vuln, cms"
echo ""
echo "Or run directly:"
echo "cd /opt/bojemoi/samsonov/pentest_orchestrator && python3 main.py -t <TARGET> -s <TYPE>"
```

### For `results`:
```bash
cd /opt/bojemoi/samsonov/pentest_orchestrator && python3 import_results.py --list-all
```

## Output Format

Show:
- Service status (running/stopped)
- Plugin connectivity
- Available scan types
- Recent results summary
